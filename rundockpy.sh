#!/bin/bash

# Ask for input
# Add params manually

if [ $# -eq 0 ]; then
    echo "Usage: ./rundockpy.sh <python version> <python script to be executed> <path to requirements.txt>"
    exit 1

fi

cat << EOF > Dockerfile
FROM python:$1

WORKDIR $PWD

COPY $3 ./
RUN pip install --no-cache-dir -r $3

COPY . .

CMD [ "python", "./$2", "<arg1>", "<arg2>" ]
EOF

docker build -t my-exploit .

docker run -it --rm --name my-exploit my-exploit

# Some other usefull docker commands...

# docker stop $(docker ps -aq)
# docker rm $(docker ps -aq)
# docker rmi $(docker images -q)
